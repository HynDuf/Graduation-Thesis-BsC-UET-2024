### Ước lượng hợp lý cực đại (Maximum Likelihood Estimation - MLE)

Ước lượng hợp lý cực đại (MLE) là một phương pháp suy diễn thống kê được sử dụng rộng rãi để ước lượng các tham số của mô hình. Nguyên tắc cốt lõi của MLE là tìm các giá trị tham số làm tối đa hóa hàm hợp lý, biểu thị xác suất quan sát dữ liệu đã cho dựa trên các tham số đó.

Trong bài toán dựng cây phát sinh loài, MLE đánh giá xác suất của dữ liệu trình tự sinh học dưới dạng một hàm của cấu trúc cây và độ dài nhánh chưa biết. Với một cấu trúc cây phát sinh loài cho trước và độ dài nhánh, các mô hình thay thế (substitution models) được sử dụng để tính xác suất thay đổi trạng thái dọc theo các nhánh. Cụ thể, nếu `len` biểu thị độ dài của một nhánh trên cây, các mô hình thay thế cho phép tính \( p_{ij}(len) \), là xác suất chuyển từ ký tự \( i \) sang ký tự \( j \) dọc theo một nhánh có độ dài \( len \), trong đó \( i \) và \( j \) là các ký tự trong hàng sắp xếp trình tự (multiple sequence alignment).

Gọi \( L(T, len, \theta) \) là hàm hợp lý tương ứng với sắp xếp \( A_{data} \) cho cấu trúc cây \( T \), vectơ độ dài nhánh \( len \), và mô hình thay thế \( \theta \). Hàm này được định nghĩa như sau:

\[
L(A_{data}|T, len, \theta) = \prod_{i=1}^{n} P(A_{data}^{i}|T, len, \theta) \tag{3.1}
\]

Ở đây, \( A_{data}^{i} \) là cột thứ \( i \) của sắp xếp \( A_{data} \), và \( P(A_{data}^{i}|T, len, \theta) \) là giá trị hợp lý cho cột \( i \). Phương trình 3.1 giả định rằng sự tiến hóa tại các cột khác nhau trong \( A_{data} \) là độc lập, cho phép tính hợp lý của cây bằng cách nhân các giá trị hợp lý cho từng cột. Giá trị hợp lý cho mỗi cột được tính bằng thuật toán cắt tỉa Felsenstein, như sau:

\[
P(A_{data}^{i}|T, len, \theta) = \sum_{x} \pi_{x} L_{u}(x) = \sum_{x} \pi_{x} \prod_{v} \left( \sum_{y} L_{v}(y) \cdot p_{xy}(len_{v}) \right) \tag{3.2}
\]

Ở đây, \( u \) là nút hiện tại đang xét, \( v \) là một nút con của \( u \), \( L_{j}(k) \) là giá trị hợp lý tại nút \( j \) giả định nút \( j \) có ký tự \( k \), \( \pi_{k} \) là tần số ổn định của ký tự \( k \), và \( x, y \) đại diện cho các ký tự trong hàng sắp xếp trình tự.

---

### Tiêu chí Bayes (Bayesian Criterion)

Tiêu chí Bayes sử dụng suy diễn Bayes để đánh giá một cấu trúc cây. Với một vectơ độ dài nhánh \( len \) và mô hình thay thế \( \theta \), công thức sau đánh giá mức độ phù hợp của cấu trúc cây \( T \) với sắp xếp \( A_{data} \):

\[
P(T, len, \theta|A_{data}) = \frac{P(A_{data}|T, len, \theta) \cdot P(T, len, \theta)}{P(D)} \tag{3.3}
\]

Trong đó:
- \( P(A_{data}|T, len, \theta) \) là xác suất hợp lý của \( A_{data} \) cho cây \( T \),
- \( P(T, len, \theta) \) là xác suất tiên nghiệm, và
- \( P(D) \) là xác suất biên.

Xác suất hợp lý \( P(A_{data}|T, len, \theta) \) được tính bằng thuật toán cắt tỉa Felsenstein. Do không gian tìm kiếm rất lớn, tiêu chí Bayes thường được sử dụng cùng các thuật toán Markov Chain Monte Carlo (MCMC) để xấp xỉ.

---

### Tiêu chí Tiết kiệm Tối đa (Maximum Parsimony - MP)

